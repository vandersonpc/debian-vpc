const TRENDING_NOW_URL="https://www.etsy.com/market/trending_now",UNINSTALL_REDIRECT_URL="https://everbee.io/uninstall",INSTALL_REDIRECT_URL="https://app.everbee.io/redirectingLoader",UPDATE_REDIRECT_URL="https://everbee.io/everbee-update",CONTACT_US_URL="https://everbee.io/contact-us";function storageSet({key:e,value:t}){return new Promise((o=>{chrome.storage?.local.set({[e]:t},(function(){o()}))}))}function storageGet(e){return new Promise((t=>{chrome.storage?.local.get([e],(function(o){t(o[e])}))}))}async function checkIsPinned(){let e=await chrome.action.getUserSettings();await storageSet({key:"extInfo",value:e})}chrome.runtime.onInstalled.addListener((async function(e){chrome.action.setBadgeText({text:"ON"}),chrome.action.setBadgeBackgroundColor({color:"rgb(32, 179, 32)"}),await storageSet({key:"activeExt",value:!0}),"install"===e.reason?chrome.tabs.create({url:INSTALL_REDIRECT_URL}):"update"===e.reason&&setTimeout((function(){chrome.tabs.query({url:"https://www.etsy.com/*"},(function(e){e.forEach((function(e,t){chrome.tabs.reload(e.id)}))}))}),500)})),chrome.runtime.setUninstallURL(UNINSTALL_REDIRECT_URL),chrome.action.onClicked.addListener((async function(e){await storageGet("activeExt")?(chrome.action.setBadgeText({text:"OFF"}),chrome.action.setBadgeBackgroundColor({color:"#f00"}),await storageSet({key:"activeExt",value:!1})):(chrome.action.setBadgeText({text:"ON"}),chrome.action.setBadgeBackgroundColor({color:"rgb(32, 179, 32)"}),await storageSet({key:"activeExt",value:!0})),setTimeout((function(){chrome.tabs.query({url:"https://www.etsy.com/*"},(function(e){e.forEach((function(e,t){chrome.tabs.reload(e.id)}))}))}),500)})),chrome.tabs.onUpdated.addListener((function(e,t,o){"complete"!=t.status&&"loading"!=t.status||checkIsPinned()}));