(()=>{"use strict";!function(){if(!window.login){window.login=!0;var e=document.getElementById("login-form"),t=document.getElementById("error-message"),n=document.getElementById("goBack"),o=document.getElementById("reset-password"),s=document.getElementById("create-account"),a=document.getElementById("force-logout"),l=document.getElementById("force-logout-info"),c=document.querySelector(".title .loading-container");e.addEventListener("submit",(function(e){e.preventDefault(),c.style.display="block";var n=document.getElementById("email").value,o=document.getElementById("password").value;chrome.runtime.sendMessage({type:"LOGIN",email:n,password:o},(function(e){(c.style.display="none","success"===e.status)?(chrome.storage&&chrome.storage.local).set({userEmail:n},(function(){window.location.replace("../purchase/purchase.html")})):"error"===e.status&&(console.error(e.message),"auth/email-not-verified"===e.code?(t.textContent=e.message,a.style.display="none",l.style.display="none"):"auth/max-sessions-exceeded"===e.code?(t.textContent="You've reached the maximum number of active sessions. Please log out from another device.",a.style.display="block",l.style.display="block"):(t.textContent="Unable to log in. Please check your email and password and try again.",a.style.display="none",l.style.display="none"))}))})),n.addEventListener("click",(function(e){e.preventDefault(),window.location.replace("../purchase/purchase.html")})),s.addEventListener("click",(function(e){e.preventDefault(),window.location.replace("./create/createAccount.html")})),o.addEventListener("click",(function(e){e.preventDefault();var t=document.getElementById("email").value;t?(c.style.display="block",chrome.runtime.sendMessage({type:"RESET_PASSWORD",email:t},(function(e){c.style.display="none";var t=document.getElementById("error-message");"success"===e.status?(t.textContent="If the email exists in our system, you will receive a link to reset your password.",t.style.color="#0ca37f"):"error"===e.status&&(console.log(e.message),t.textContent="Unable to reset password. If you have not created an account please create one.",t.style.color="#ff7f7f")}))):document.getElementById("error-message").textContent="Please enter your email"})),a.addEventListener("click",(function(e){if(e.preventDefault(),window.confirm("Are you sure you want to log out from all devices?")){var n=document.getElementById("email").value;c.style.display="block",chrome.runtime.sendMessage({type:"FORCE_LOGOUT",email:n},(function(e){c.style.display="none","success"===e.status?(t.textContent="An email has been sent, please confirm this action through the email.",t.style.color="#0ca37f",a.style.display="none",l.style.display="none"):"error"===e.status&&(console.log(e.message),t.textContent="Unable to force log out. Please try again.",t.style.color="#ff7f7f")}))}}))}}()})();