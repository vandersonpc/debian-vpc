!function(){function t(t,i,e){this.defaultType=e||"default",this.$root=$(t),this.html="",this.type=this.defaultType,this.timeout=0,this.timer=null,this.animations=i||{}}t.prototype.set=function(t){this.clear(),t.timeout?this.timeout=parseInt(t.timeout):this.timeout=0,this.html=t.html,this.type=t.type||this.defaultType,this.render()},t.prototype.success=function(t,i){i=i||0,this.set({type:"success",html:t,timeout:i})},t.prototype.error=function(t,i){i=i||0,this.set({type:"danger",html:t,timeout:i})},t.prototype.clear=function(){this.$root.html(""),this.type=this.defaultType,this.timer&&(clearTimeout(this.timer),this.timer=null)},t.prototype.render=function(){if(this.$root[0]){var t=$('<div class="alert"></div>').appendTo(this.$root);if(t.html(this.html).addClass("alert-"+this.type).hide(),this.animations.show){var i=this.animations.show.method;t[i].apply(t,this.animations.show.params)}else t.show();var e=this;this.timeout&&(this.timer=setTimeout((function(){if(e.animations.hide){var i=e.animations.hide.method;t[i].apply(t,e.animations.hide.params)}else t.remove()}),this.timeout))}else console.log("Status: "+this.html,this)},window.StatusHelper=t}();
(function(){var e=function(){var e=$("<div/>").attr("id","hint-popup").appendTo($("body"));$(".version").text("Version "+chrome.runtime.getManifest().version),$("#license-key").change((function(e){var t=$.trim($("#license-key").val());chrome.runtime.sendMessage({cmd:"settings.set",data:{license:t}})})),$("#btn-verify").click((function(){var e=$.trim($("#license-key").val()),t=new StatusHelper($("#license-status"),{show:{method:"slideDown",params:[]},hide:{method:"slideUp",params:[]}});e?chrome.runtime.sendMessage({cmd:"gumroad.get",data:{nocache:!0,key:e}},(function(e){console.log(e),e.error?t.error(e.data,3e3):t.success("Success!",2e3)})):t.error("Empty key",2e3)})),$(".toggle-button").click((function(){this.dataset.state="on"===this.dataset.state?"off":"on"})),$("#toggle-extension").click((function(){chrome.runtime.sendMessage({cmd:"app.set_state",data:{state:"on"===this.dataset.state}})})),$(".tab").click((function(e){e.preventDefault();var t=$(this);$(".tab.active").removeClass("active"),t.addClass("active");var s=this.dataset.target;$(".tab-content").removeClass("active"),$(".tab-content[data-tab="+s+"]").addClass("active")})),$("input[type=checkbox], input[type=number]").change((function(){var e=this.value;"number"===this.type&&(e=parseInt(e)||0),"checkbox"===this.type&&(e=!!this.checked);var t={};t[this.id]=e,chrome.runtime.sendMessage({cmd:"settings.set",data:t})})),$("[data-hint]").hover((function(t){e.html(this.dataset.hint),e.show().css("top",t.pageY+15).css("left",($("body").width()-e.width())/2)}),(function(t){t.toElement!==e[0]&&e.hide()}))};return{init:function(){chrome.runtime.sendMessage({cmd:"wakeup"},(function(){chrome.runtime.lastError,chrome.runtime.sendMessage({cmd:"app.get_state",data:{}},(function(e){chrome.runtime.lastError||($("#toggle-extension")[0].dataset.state=e.state?"on":"off",$("#license-key").val(e.settings.license),e.visitTimestamp||($(".tab[data-target=license]").removeClass("hidden"),$("[data-tab=license]").removeClass("hidden"),e.settings.license||$(".tab[data-target=license]").click()),$("#showExtInfo").prop("checked",e.settings.showExtInfo),$("#showPopupByKeypress").prop("checked",e.settings.showPopupByKeypress),$("#showTopRight").prop("checked",e.settings.showTopRight),$("#showFilters").prop("checked",e.settings.showFilters),$("#hideSubrank").prop("checked",e.settings.hideSubrank),$("#showBBHolder").prop("checked",e.settings.showBBHolder),$("#hideSoldByAmz").prop("checked",e.settings.hideSoldByAmz),$("#hidePrime").prop("checked",e.settings.hidePrime),$("#hideSponsored").prop("checked",e.settings.hideSponsored),$("#hideNoBB").prop("checked",e.settings.hideNoBB),$("#filterFBASelMin").val(e.settings.filterFBASelMin||""),$("#filterFBASelMax").val(e.settings.filterFBASelMax||""),$("#tmInterval").val(e.settings.tmInterval),"expired"===e.license?$(".license").text("License Expired"):e.license||$(".license").text("No License"))})),e()}))}}})().init();